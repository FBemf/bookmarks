{{ template "base" . }}

{{ define "head" }}
<title>Edit {{ .Bookmark.Name }}</title>
<script src="https://unpkg.com/stimulus/dist/stimulus.umd.js"></script>
<script src="/static/controllers.js"></script>
{{ end }}

{{ define "body" }}
<h1>Editing {{ .Bookmark.Name }}</h1>
{{ template "nav" . }}

<hr>

<turbo-frame id="entry-{{ .Bookmark.Id }}">
    <div class="list-entry editform">
        <a class="editform__cancel"
            href="/bookmarks/view/{{ .Bookmark.Id }}{{ .SearchParams | paramQueryString }}">Cancel</a>
        <div class="spacer"></div>
        <form method="POST" action="/bookmarks/edit/{{ .Bookmark.Id }}{{ .SearchParams | paramQueryString }}">
            <label class="tight" for="form-name">Name</label>
            <input class="longfield" id="form-name" type="text" name="name" placeholder="Name"
                value="{{ .Bookmark.Name }}" autocomplete="off">
            <label class="tight" for="form-url">URL</label>
            <input class="longfield" for="form-url" type="text" name="url" placeholder="https://www.example.com"
                value="{{ .Bookmark.Url }}" autocomplete="off">
            <label class="tight" for="form-description">Description</label>
            <input class="longfield" id="form-description" type="text" name="description" placeholder="Description"
                value="{{ .Bookmark.Description }}" autocomplete="off">
            <div data-controller="bookmark-tagger">
                <div class="editform__field">
                    <label for="form-tags">Tags</label>
                    <input id="form-tags" data-bookmark-tagger-target="tagName"
                        data-action="keydown->bookmark-tagger#addTag" type="text" placeholder="Tag name" value=""
                        autocomplete="off">
                    <button type="button" data-action="click->bookmark-tagger#addTag">Add tag</button>
                </div>
                <div data-bookmark-tagger-target="tagList">
                    {{ range .Bookmark.Tags }}
                    <span class="taglist__tag" data-controller="tag" data-tag-target="self">
                        <input type="hidden" name="tag" value="{{ . }}">
                        {{ . }}
                        <button class="link" data-action="click->tag#remove" type="button">Ã—</button>
                        &nbsp;
                    </span>
                    {{ end }}
                </div>
            </div>
            <input class="editform__submit-button" type="submit" value="Update">
        </form>
        <div class="editform__delete-button" data-controller="are-you-sure">
            <button data-are-you-sure-target="initial" data-action="click->are-you-sure#prime">Delete</button>
            <form data-are-you-sure-target="primary" method="POST"
                action="/bookmarks/delete/{{ .Bookmark.Id }}{{ .SearchParams | paramQueryString }}"
                data-turbo-frame="list" style="display: none">
                Are you sure?&nbsp;
                <button>Delete</button></a>&nbsp;
                <button type="button" data-action="click->are-you-sure#cancel">Cancel</button>
            </form>
        </div>
    </div>
</turbo-frame>
{{ end }}